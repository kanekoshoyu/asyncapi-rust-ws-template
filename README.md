[![AsyncAPI logo](./assets/logo_banner.png)](https://www.asyncapi.com)

# asyncapi-rust-ws-template
> AsyncAPI rust websocket client generator using react renderer

![npm version](https://img.shields.io/npm/v/asyncapi-rust-ws-template.svg)
[![license](https://img.shields.io/github/license/kanekoshoyu/exchange-collection)](https://github.com/kanekoshoyu/exchange-collection/blob/master/LICENSE)
[![discord](https://img.shields.io/discord/1153997271294283827)](https://discord.gg/q3j5MYdwnm)
## design
- renderer: react rather than nunjucks, for its versatility. for details, click [here](https://www.asyncapi.com/docs/tools/generator/file-templates)

## contents
| name                             | description                                                                                                   |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| [src](./src/)                    | TypeScript source code, transpiles into `template` directory that                                             |
| [src/index.ts](./src/index.ts)   | transpiles to main template entry `template/index.js`, exposing the function for `asyncapi generator` command |
| [test/input](./test/)            | local sample AsyncAPI document for testing purpose                                                            |
| [test/output](./test/)           | local test output directory                                                                                   |
| [package.json](./package.json)   | NPM package definition                                                                                        |
| [tsconfig.json](./tsconfig.json) | TypeScript transpile definition                                                                               |
| [CHANGELOG](./CHANGELOG.md)      | change log                                                                                                    |

## command
render using npm build
```
ag sample/a.yaml "asyncapi-rust-ws-template" -o output -p validate=true -p render=true
```
render using github build
```
ag https://raw.githubusercontent.com/kanekoshoyu/exchange-collection/main/asset/binance_ws_asyncapi.yaml ./ -o output  -p validate=true -p render=true
```
render using local build
```
ag sample/a.yaml ./ -o output -p validate=true -p render=true
```

## template input (AsyncAPI)
| spec                                      | requirement                                                                         |
| ----------------------------------------- | ----------------------------------------------------------------------------------- |
| format                                    | AsyncAPI v2.0.0+                                                                    |
| minimum content requirement for WS client | `info`, `servers`, `channels`, `components` , can be tested with `-p validate=true` |


## template parameters
| parameter   | options                                           | description                                                                   |
| ----------- | ------------------------------------------------- | ----------------------------------------------------------------------------- |
| `validate`  | `true` `false` (default)                          | to validate if a AsyncAPI has minimum content for generating websocket client |
| `render`    | `true` `false` (default)                          | to render a rust websocket client                                             |
| `framework` | `tokio-tungstenite` (default) `async-tungstenite` | rust websocket client framework to render                                     |

## installation for dev
install react
```
npm install react
```
install typescript transpiler
```
npm install @types/react --save-devnpm install typescript @types/node --save-dev
```

## template output (rust code)
The `rust` code generated by this template has the following structure
- `Cargo.toml` // using info
- `README.md` // using info
- `/src`
  - `lib.rs`
  - `/client`
    - `_client.rs` // using servers
    - `/channel`
      - `_channel.rs` // using channels
    - `mod.rs`
  - `/model`
    - `_messsage.rs` // using components
    - `mod.rs`

## TODO
- [x] design codegen structure
  - [x] study nunjucks vs react (decided to use react)
- [ ] code generation
  - [x] define code structure
  - [ ] implement tungstenite websocket api call
  - [ ] fix modelina referencing other model as `crate::*`;
- [ ] code testing
  - [ ] unit test

## recruitment
#### TypeScript AsyncAPI Template Developer
I am not a TS expert, so I would love to have an expert to accelarate development.  

## see also
- [guilder](https://github.com/kanekoshoyu/guilder) - Unopinionated Cross-Exchange Crypto Trading Library
- [exchange-collection](https://github.com/kanekoshoyu/exchange-collection) - Crypto Exchange OpenAPI(REST) / AsyncAPI(WS) and Clients
- [kucoin-arbitrage](https://github.com/kanekoshoyu/kucoin_arbitrage) - KuCoin Cyclic Arbitrage, in Tokio Rust (legacy)
